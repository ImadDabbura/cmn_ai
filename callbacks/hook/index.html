
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../core/">
      
      
        <link rel="next" href="../training/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Hooks - cmn_ai</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cmn_ai.callbacks.hook" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="cmn_ai" class="md-header__button md-logo" aria-label="cmn_ai" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            cmn_ai
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Hooks
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/ImadDabbura/cmn_ai" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    ImadDabbura/cmn_ai
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="cmn_ai" class="md-nav__button md-logo" aria-label="cmn_ai" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    cmn_ai
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ImadDabbura/cmn_ai" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    ImadDabbura/cmn_ai
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../learner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Learner
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../activations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Activations
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plotting
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tabular
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Tabular
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tabular/data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tabular/eda/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EDA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tabular/preprocessing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Preprocessing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Vision
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Vision
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vision/data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vision/core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Text
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Text
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../text/data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Callbacks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Callbacks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Hooks
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Hooks
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook" class="md-nav__link">
    <span class="md-ellipsis">
      hook
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.ActivationStats" class="md-nav__link">
    <span class="md-ellipsis">
      ActivationStats
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ActivationStats">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.ActivationStats.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.ActivationStats.dead_chart" class="md-nav__link">
    <span class="md-ellipsis">
      dead_chart
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.ActivationStats.plot_hist" class="md-nav__link">
    <span class="md-ellipsis">
      plot_hist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.ActivationStats.plot_stats" class="md-nav__link">
    <span class="md-ellipsis">
      plot_stats
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hook" class="md-nav__link">
    <span class="md-ellipsis">
      Hook
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hook">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hook.__del__" class="md-nav__link">
    <span class="md-ellipsis">
      __del__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hook.__enter__" class="md-nav__link">
    <span class="md-ellipsis">
      __enter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hook.__exit__" class="md-nav__link">
    <span class="md-ellipsis">
      __exit__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hook.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hook.remove" class="md-nav__link">
    <span class="md-ellipsis">
      remove
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hooks" class="md-nav__link">
    <span class="md-ellipsis">
      Hooks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hooks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hooks.__del__" class="md-nav__link">
    <span class="md-ellipsis">
      __del__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hooks.__enter__" class="md-nav__link">
    <span class="md-ellipsis">
      __enter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hooks.__exit__" class="md-nav__link">
    <span class="md-ellipsis">
      __exit__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hooks.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hooks.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hooks.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hooks.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hooks.remove" class="md-nav__link">
    <span class="md-ellipsis">
      remove
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.HooksCallback" class="md-nav__link">
    <span class="md-ellipsis">
      HooksCallback
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HooksCallback">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.HooksCallback.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.HooksCallback.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.HooksCallback.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.HooksCallback.after_fit" class="md-nav__link">
    <span class="md-ellipsis">
      after_fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.HooksCallback.before_fit" class="md-nav__link">
    <span class="md-ellipsis">
      before_fit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.compute_stats" class="md-nav__link">
    <span class="md-ellipsis">
      compute_stats
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.get_hist" class="md-nav__link">
    <span class="md-ellipsis">
      get_hist
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.get_min" class="md-nav__link">
    <span class="md-ellipsis">
      get_min
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Training
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schedule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schedule
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../losses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Losses
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/processors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Processors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utilities
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook" class="md-nav__link">
    <span class="md-ellipsis">
      hook
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.ActivationStats" class="md-nav__link">
    <span class="md-ellipsis">
      ActivationStats
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ActivationStats">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.ActivationStats.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.ActivationStats.dead_chart" class="md-nav__link">
    <span class="md-ellipsis">
      dead_chart
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.ActivationStats.plot_hist" class="md-nav__link">
    <span class="md-ellipsis">
      plot_hist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.ActivationStats.plot_stats" class="md-nav__link">
    <span class="md-ellipsis">
      plot_stats
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hook" class="md-nav__link">
    <span class="md-ellipsis">
      Hook
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hook">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hook.__del__" class="md-nav__link">
    <span class="md-ellipsis">
      __del__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hook.__enter__" class="md-nav__link">
    <span class="md-ellipsis">
      __enter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hook.__exit__" class="md-nav__link">
    <span class="md-ellipsis">
      __exit__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hook.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hook.remove" class="md-nav__link">
    <span class="md-ellipsis">
      remove
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hooks" class="md-nav__link">
    <span class="md-ellipsis">
      Hooks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hooks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hooks.__del__" class="md-nav__link">
    <span class="md-ellipsis">
      __del__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hooks.__enter__" class="md-nav__link">
    <span class="md-ellipsis">
      __enter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hooks.__exit__" class="md-nav__link">
    <span class="md-ellipsis">
      __exit__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hooks.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hooks.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hooks.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hooks.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.Hooks.remove" class="md-nav__link">
    <span class="md-ellipsis">
      remove
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.HooksCallback" class="md-nav__link">
    <span class="md-ellipsis">
      HooksCallback
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HooksCallback">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.HooksCallback.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.HooksCallback.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      __iter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.HooksCallback.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.HooksCallback.after_fit" class="md-nav__link">
    <span class="md-ellipsis">
      after_fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.HooksCallback.before_fit" class="md-nav__link">
    <span class="md-ellipsis">
      before_fit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.compute_stats" class="md-nav__link">
    <span class="md-ellipsis">
      compute_stats
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.get_hist" class="md-nav__link">
    <span class="md-ellipsis">
      get_hist
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cmn_ai.callbacks.hook.get_min" class="md-nav__link">
    <span class="md-ellipsis">
      get_min
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Hooks</h1>

<div class="doc doc-object doc-module">



<a id="cmn_ai.callbacks.hook"></a>
    <div class="doc doc-contents first">

        <p>Hooks for inspecting neural network activations and gradients during training.</p>
<p>This module provides utilities for registering hooks on PyTorch modules to inspect
what is happening during forward and backward passes. This is useful for computing
statistics of activations and gradients, debugging training issues, and monitoring
model behavior.</p>
<p>Hooks are very useful to inspect what is happening during the forward and backward
passes such as computing stats of the activations and gradients.</p>


<p><span class="doc-section-title">Functions:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><span title="cmn_ai.callbacks.hook.compute_stats : Callable">compute_stats : Callable</span></code></b>
            –
            <div class="doc-md-description">
              <p>Compute means, std, and histogram of module activations/gradients.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><span title="cmn_ai.callbacks.hook.get_hist : Callable">get_hist : Callable</span></code></b>
            –
            <div class="doc-md-description">
              <p>Return matrix-ready for plotting heatmap of activations/gradients.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><span title="cmn_ai.callbacks.hook.get_min : Callable">get_min : Callable</span></code></b>
            –
            <div class="doc-md-description">
              <p>Compute percentage of activations/gradients around zero from histogram.</p>
            </div>
          </li>
    </ul>


<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="cmn_ai.callbacks.hook.Hook : object">Hook : object</span></code></b>
          –
          <div class="doc-md-description">
            <p>Register either a forward or a backward hook on a single module.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="cmn_ai.callbacks.hook.Hooks : object">Hooks : object</span></code></b>
          –
          <div class="doc-md-description">
            <p>Register hooks on multiple modules with context manager support.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="cmn_ai.callbacks.hook.HooksCallback : Callback">HooksCallback : Callback</span></code></b>
          –
          <div class="doc-md-description">
            <p>Base class to run hooks on modules as a callback.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="cmn_ai.callbacks.hook.ActivationStats : HooksCallback">ActivationStats : HooksCallback</span></code></b>
          –
          <div class="doc-md-description">
            <p>Plot means, std, histogram, and dead activations of all modules.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Register a hook on a single module</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hook</span> <span class="o">=</span> <span class="n">Hook</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">layer1</span><span class="p">,</span> <span class="n">compute_stats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use as context manager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">Hook</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">layer1</span><span class="p">,</span> <span class="n">compute_stats</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Register hooks on multiple modules</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hooks</span> <span class="o">=</span> <span class="n">Hooks</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">children</span><span class="p">(),</span> <span class="n">compute_stats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hooks</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>  <span class="c1"># Clean up</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use as callback during training</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span> <span class="o">=</span> <span class="n">ActivationStats</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">is_forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">learner</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">stats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">plot_stats</span><span class="p">()</span>  <span class="c1"># Plot activation statistics</span>
</code></pre></div>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="cmn_ai.callbacks.hook.ActivationStats" class="doc doc-heading">
            <code>ActivationStats</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="HooksCallback (cmn_ai.callbacks.hook.HooksCallback)" href="#cmn_ai.callbacks.hook.HooksCallback">HooksCallback</a></code></p>


        <p>Plot activation/gradient statistics for all modules.</p>
<p>This class automatically computes and can plot various statistics
of module activations (or gradients if <code>is_forward=False</code>), including
means, standard deviations, histograms, and dead activation percentages.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="cmn_ai.callbacks.hook.ActivationStats.bins">bins</span></code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Number of histogram bins.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="cmn_ai.callbacks.hook.ActivationStats.bins_range">bins_range</span></code></b>
              (<code><span title="list">list</span> | <span title="tuple">tuple</span></code>)
          –
          <div class="doc-md-description">
            <p>Range for histogram bins.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Monitor activation statistics during training</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span> <span class="o">=</span> <span class="n">ActivationStats</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">is_forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">learner</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">stats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># After training, plot the statistics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">plot_stats</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">plot_hist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">dead_chart</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>  <span class="c1"># Show dead activations in bins 0-4</span>
</code></pre></div>










  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cmn_ai.callbacks.hook.ActivationStats.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">modules</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_forward</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">bins_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize the activation statistics callback.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>modules</code></b>
              (<code><span title="torch.nn.Module">Module</span> | <span title="typing.Iterable">Iterable</span>[<span title="torch.nn.Module">Module</span>] | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Modules to register the hook on. If None, uses all model children.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>is_forward</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to monitor activations (True) or gradients (False).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>bins</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>40</code>
)
          –
          <div class="doc-md-description">
            <p>Number of histogram bins.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>bins_range</code></b>
              (<code><span title="list">list</span> | <span title="tuple">tuple</span></code>, default:
                  <code>(0, 10)</code>
)
          –
          <div class="doc-md-description">
            <p>Lower and upper bounds for histogram bins.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cmn_ai.callbacks.hook.ActivationStats.dead_chart" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dead_chart</span><span class="p">(</span><span class="n">bins_range</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Plot a line chart of the "dead" activations percentage.</p>
<p>Shows the percentage of activations/gradients that fall within
the specified range around zero over time, which can help identify
when neurons become inactive.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>bins_range</code></b>
              (<code><span title="list">list</span> | <span title="tuple">tuple</span></code>)
          –
          <div class="doc-md-description">
            <p>Range of bins around zero to consider as "dead" activations/gradients.
Should be a slice-like object (e.g., [0, 5] for bins 0-4).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>figsize</code></b>
              (<code><span title="tuple">tuple</span></code>, default:
                  <code>(11, 5)</code>
)
          –
          <div class="doc-md-description">
            <p>Width and height of the figure in inches.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cmn_ai.callbacks.hook.ActivationStats.plot_hist" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_hist</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Plot histogram of activations/gradients as a heatmap.</p>
<p>Creates a heatmap visualization where each row represents a histogram
bin and each column represents a timestep during training.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>figsize</code></b>
              (<code><span title="tuple">tuple</span></code>, default:
                  <code>(11, 5)</code>
)
          –
          <div class="doc-md-description">
            <p>Width and height of the figure in inches.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cmn_ai.callbacks.hook.ActivationStats.plot_stats" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_stats</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Plot means and standard deviations of activations/gradients.</p>
<p>Creates two subplots showing the mean and standard deviation
of activations/gradients for each layer over time.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>figsize</code></b>
              (<code><span title="tuple">tuple</span></code>, default:
                  <code>(10, 4)</code>
)
          –
          <div class="doc-md-description">
            <p>Width and height of the figure in inches.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="cmn_ai.callbacks.hook.Hook" class="doc doc-heading">
            <code>Hook</code>


</h2>


    <div class="doc doc-contents ">


        <p>Register either a forward or a backward hook on a single module.</p>
<p>This class provides a convenient way to register hooks on PyTorch modules
and automatically handle cleanup. It can be used as a context manager
for automatic hook removal.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="cmn_ai.callbacks.hook.Hook.is_forward">is_forward</span></code></b>
              (<code><span title="bool">bool</span></code>)
          –
          <div class="doc-md-description">
            <p>Whether the hook is a forward or backward hook.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="cmn_ai.callbacks.hook.Hook.hook">hook</span></code></b>
              (<code><span title="torch.utils.hooks.RemovableHandle">RemovableHandle</span></code>)
          –
          <div class="doc-md-description">
            <p>The registered hook handle for cleanup.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">hook</span> <span class="o">=</span> <span class="n">Hook</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">layer1</span><span class="p">,</span> <span class="n">compute_stats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ... use the hook</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hook</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use as context manager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">Hook</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">layer1</span><span class="p">,</span> <span class="n">compute_stats</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</code></pre></div>










  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cmn_ai.callbacks.hook.Hook.__del__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__del__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Destructor to ensure hook removal.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cmn_ai.callbacks.hook.Hook.__enter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__enter__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Enter the context manager.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="Hook (cmn_ai.callbacks.hook.Hook)" href="#cmn_ai.callbacks.hook.Hook">Hook</a></code>
          –
          <div class="doc-md-description">
            <p>Self reference for context manager usage.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cmn_ai.callbacks.hook.Hook.__exit__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__exit__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Exit the context manager and remove the hook.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cmn_ai.callbacks.hook.Hook.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">is_forward</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize the hook.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>module</code></b>
              (<code><span title="torch.nn.Module">Module</span></code>)
          –
          <div class="doc-md-description">
            <p>The module to register the hook on.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>func</code></b>
              (<code><span title="typing.Callable">Callable</span></code>)
          –
          <div class="doc-md-description">
            <p>The hook function to be registered. Should accept (hook, module, input, output)
for forward hooks or (hook, module, grad_input, grad_output) for backward hooks.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>is_forward</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to register <code>func</code> as a forward or backward hook.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments to pass to the hook function.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cmn_ai.callbacks.hook.Hook.remove" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Remove the registered hook.</p>
<p>This method removes the hook from the module and should be called
to prevent memory leaks.</p>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="cmn_ai.callbacks.hook.Hooks" class="doc doc-heading">
            <code>Hooks</code>


</h2>


    <div class="doc doc-contents ">


        <p>Register hooks on multiple modules with convenient management.</p>
<p>This class provides a container for multiple hooks with convenient
iteration, indexing, and cleanup methods. It can be used as a context
manager for automatic cleanup of all hooks.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="cmn_ai.callbacks.hook.Hooks.hooks">hooks</span></code></b>
              (<code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="Hook (cmn_ai.callbacks.hook.Hook)" href="#cmn_ai.callbacks.hook.Hook">Hook</a>]</code>)
          –
          <div class="doc-md-description">
            <p>List of registered hooks.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">hooks</span> <span class="o">=</span> <span class="n">Hooks</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">children</span><span class="p">(),</span> <span class="n">compute_stats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">hook</span> <span class="ow">in</span> <span class="n">hooks</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">hook</span><span class="o">.</span><span class="n">stats</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hooks</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use as context manager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">Hooks</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">children</span><span class="p">(),</span> <span class="n">compute_stats</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</code></pre></div>










  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cmn_ai.callbacks.hook.Hooks.__del__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__del__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Destructor to ensure all hooks are removed.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cmn_ai.callbacks.hook.Hooks.__enter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__enter__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Enter the context manager.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="Hooks (cmn_ai.callbacks.hook.Hooks)" href="#cmn_ai.callbacks.hook.Hooks">Hooks</a></code>
          –
          <div class="doc-md-description">
            <p>Self reference for context manager usage.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cmn_ai.callbacks.hook.Hooks.__exit__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__exit__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Exit the context manager and remove all hooks.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cmn_ai.callbacks.hook.Hooks.__getitem__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get a hook by index.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>idx</code></b>
              (<code><span title="int">int</span></code>)
          –
          <div class="doc-md-description">
            <p>Index of the hook to retrieve.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-internal" title="Hook (cmn_ai.callbacks.hook.Hook)" href="#cmn_ai.callbacks.hook.Hook">Hook</a></code>
          –
          <div class="doc-md-description">
            <p>The hook at the specified index.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cmn_ai.callbacks.hook.Hooks.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">modules</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">is_forward</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize hooks for multiple modules.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>modules</code></b>
              (<code><span title="typing.Iterable">Iterable</span>[<span title="torch.nn.Module">Module</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Iterable of modules to register hooks on.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>func</code></b>
              (<code><span title="typing.Callable">Callable</span></code>)
          –
          <div class="doc-md-description">
            <p>The hook function to be registered on each module.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>is_forward</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to register <code>func</code> as a forward or backward hook.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>**kwargs</code></b>
          –
          <div class="doc-md-description">
            <p>Additional keyword arguments to pass to the hook function.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cmn_ai.callbacks.hook.Hooks.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Iterate over all hooks.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.Iterator">Iterator</span>[<a class="autorefs autorefs-internal" title="Hook (cmn_ai.callbacks.hook.Hook)" href="#cmn_ai.callbacks.hook.Hook">Hook</a>]</code>
          –
          <div class="doc-md-description">
            <p>Iterator over all registered hooks.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cmn_ai.callbacks.hook.Hooks.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the number of hooks.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="int">int</span></code>
          –
          <div class="doc-md-description">
            <p>Number of registered hooks.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cmn_ai.callbacks.hook.Hooks.remove" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Remove all registered hooks.</p>
<p>This method removes all hooks from their respective modules and
should be called to prevent memory leaks.</p>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="cmn_ai.callbacks.hook.HooksCallback" class="doc doc-heading">
            <code>HooksCallback</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Callback (cmn_ai.callbacks.core.Callback)" href="../core/#cmn_ai.callbacks.core.Callback">Callback</a></code></p>


        <p>Base class to run hooks on modules as a callback.</p>
<p>This class provides a convenient way to register and manage hooks
during training using the callback system. It automatically handles
hook registration before training and cleanup after training.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><span title="cmn_ai.callbacks.hook.HooksCallback.hookfunc">hookfunc</span></code></b>
              (<code><span title="typing.Callable">Callable</span></code>)
          –
          <div class="doc-md-description">
            <p>The hook function to be registered on modules.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="cmn_ai.callbacks.hook.HooksCallback.on_train">on_train</span></code></b>
              (<code><span title="bool">bool</span></code>)
          –
          <div class="doc-md-description">
            <p>Whether to run hooks during training.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="cmn_ai.callbacks.hook.HooksCallback.on_valid">on_valid</span></code></b>
              (<code><span title="bool">bool</span></code>)
          –
          <div class="doc-md-description">
            <p>Whether to run hooks during validation.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="cmn_ai.callbacks.hook.HooksCallback.modules">modules</span></code></b>
              (<code><span title="list">list</span>[<span title="torch.nn.Module">Module</span>]</code>)
          –
          <div class="doc-md-description">
            <p>List of modules to register hooks on.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="cmn_ai.callbacks.hook.HooksCallback.is_forward">is_forward</span></code></b>
              (<code><span title="bool">bool</span></code>)
          –
          <div class="doc-md-description">
            <p>Whether to register forward or backward hooks.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><span title="cmn_ai.callbacks.hook.HooksCallback.hooks">hooks</span></code></b>
              (<code><a class="autorefs autorefs-internal" title="Hooks (cmn_ai.callbacks.hook.Hooks)" href="#cmn_ai.callbacks.hook.Hooks">Hooks</a></code>)
          –
          <div class="doc-md-description">
            <p>The hooks object managing all registered hooks.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a custom hook callback</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">MyHookCallback</span><span class="p">(</span><span class="n">HooksCallback</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">compute_stats</span><span class="p">,</span> <span class="n">on_train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">on_valid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">callback</span> <span class="o">=</span> <span class="n">MyHookCallback</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">learner</span><span class="o">.</span><span class="n">add_callback</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
</code></pre></div>










  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cmn_ai.callbacks.hook.HooksCallback.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">hookfunc</span><span class="p">,</span> <span class="n">on_train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">on_valid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">modules</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize the hooks callback.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>hookfunc</code></b>
              (<code><span title="typing.Callable">Callable</span></code>)
          –
          <div class="doc-md-description">
            <p>The hook function to be registered on modules.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>on_train</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to run the hook on modules during training.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>on_valid</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>False</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to run the hook on modules during validation.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>modules</code></b>
              (<code><span title="torch.nn.Module">Module</span> | <span title="typing.Iterable">Iterable</span>[<span title="torch.nn.Module">Module</span>] | None</code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>Modules to register the hook on. If None, uses all model children.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>is_forward</code></b>
              (<code><span title="bool">bool</span></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to register forward or backward hooks.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cmn_ai.callbacks.hook.HooksCallback.__iter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Iterate over all registered hooks.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="typing.Iterator">Iterator</span>[<a class="autorefs autorefs-internal" title="Hook (cmn_ai.callbacks.hook.Hook)" href="#cmn_ai.callbacks.hook.Hook">Hook</a>]</code>
          –
          <div class="doc-md-description">
            <p>Iterator over all registered hooks.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cmn_ai.callbacks.hook.HooksCallback.__len__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the number of registered hooks.</p>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="int">int</span></code>
          –
          <div class="doc-md-description">
            <p>Number of registered hooks.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cmn_ai.callbacks.hook.HooksCallback.after_fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">after_fit</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Remove all hooks after training ends.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cmn_ai.callbacks.hook.HooksCallback.before_fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">before_fit</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Register hooks before training begins.</p>
<p>If no modules are specified, registers hooks on all model children.</p>


    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="cmn_ai.callbacks.hook.compute_stats" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_stats</span><span class="p">(</span><span class="n">hook</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">inp</span><span class="p">,</span> <span class="n">outp</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">bins_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Compute the means, std, and histogram of module activations/gradients.</p>
<p>This function is designed to be used as a hook function. It computes
statistics of the module's output (activations for forward hooks,
gradients for backward hooks) and stores them in the hook object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>hook</code></b>
              (<code><a class="autorefs autorefs-internal" title="Hook (cmn_ai.callbacks.hook.Hook)" href="#cmn_ai.callbacks.hook.Hook">Hook</a></code>)
          –
          <div class="doc-md-description">
            <p>The registered hook object where stats will be stored.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>module</code></b>
              (<code><span title="torch.nn.Module">Module</span></code>)
          –
          <div class="doc-md-description">
            <p>The module that the hook is registered on.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>inp</code></b>
              (<code><span title="torch.Tensor">Tensor</span></code>)
          –
          <div class="doc-md-description">
            <p>Input to the module (for forward hooks) or gradient input (for backward hooks).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>outp</code></b>
              (<code><span title="torch.Tensor">Tensor</span></code>)
          –
          <div class="doc-md-description">
            <p>Output from the module (for forward hooks) or gradient output (for backward hooks).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>bins</code></b>
              (<code><span title="int">int</span></code>, default:
                  <code>40</code>
)
          –
          <div class="doc-md-description">
            <p>Number of histogram bins.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>bins_range</code></b>
              (<code><span title="list">list</span> | <span title="tuple">tuple</span></code>, default:
                  <code>(0, 10)</code>
)
          –
          <div class="doc-md-description">
            <p>Lower and upper bounds for the histogram bins.</p>
          </div>
        </li>
    </ul>


<details class="note" open>
  <summary>Notes</summary>
  <p>The computed statistics are stored in <code>hook.stats</code> as a tuple of three lists:</p>
<ul>
<li><code>hook.stats[0]</code>: List of mean values</li>
<li><code>hook.stats[1]</code>: List of standard deviation values</li>
<li><code>hook.stats[2]</code>: List of histogram tensors</li>
</ul>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cmn_ai.callbacks.hook.get_hist" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_hist</span><span class="p">(</span><span class="n">hook</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Return matrix-ready for plotting heatmap of activations/gradients.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>hook</code></b>
              (<code><a class="autorefs autorefs-internal" title="Hook (cmn_ai.callbacks.hook.Hook)" href="#cmn_ai.callbacks.hook.Hook">Hook</a></code>)
          –
          <div class="doc-md-description">
            <p>Hook object containing histogram statistics.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="torch.Tensor">Tensor</span></code>
          –
          <div class="doc-md-description">
            <p>Matrix of histogram data ready for plotting as a heatmap.
Shape is (bins, timesteps) with log1p applied for better visualization.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cmn_ai.callbacks.hook.get_min" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_min</span><span class="p">(</span><span class="n">hook</span><span class="p">,</span> <span class="n">bins_range</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Compute the percentage of activations/gradients around zero.</p>
<p>This function calculates what percentage of the activations or gradients
fall within the specified range around zero, which can be useful for
identifying "dead" neurons or gradients.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>hook</code></b>
              (<code><a class="autorefs autorefs-internal" title="Hook (cmn_ai.callbacks.hook.Hook)" href="#cmn_ai.callbacks.hook.Hook">Hook</a></code>)
          –
          <div class="doc-md-description">
            <p>Hook object containing histogram statistics.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>bins_range</code></b>
              (<code><span title="list">list</span> | <span title="tuple">tuple</span></code>)
          –
          <div class="doc-md-description">
            <p>Range of bins around zero to consider as "dead" activations/gradients.
Should be a slice-like object (e.g., [0, 5] for bins 0-4).</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="torch.Tensor">Tensor</span></code>
          –
          <div class="doc-md-description">
            <p>Percentage of activations/gradients around zero for each timestep.
Values range from 0 to 1.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get percentage of activations in bins 0-4 (around zero)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dead_percentage</span> <span class="o">=</span> <span class="n">get_min</span><span class="p">(</span><span class="n">hook</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dead activations: </span><span class="si">{</span><span class="n">dead_percentage</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>


    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/ImadDabbura/cmn_ai" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/ImadPhd" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/imaddabbura/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://medium.com/@ImadPhd" target="_blank" rel="noopener" title="medium.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M369.4 32c43.4 0 78.6 35.2 78.6 78.6v83.8c-1.9-.1-3.8-.2-5.7-.2h-.4c-10 0-22.3 2.4-31.1 6.8-10 4.6-18.7 11.5-26 20.6-11.8 14.6-18.9 34.3-20.6 56.4-.1.7-.1 1.3-.2 2s-.1 1.2-.1 1.9c-.1 1.2-.1 2.4-.1 3.6 0 1.9-.1 3.8 0 5.8 1.2 50.1 28.2 90.2 76.3 90.2 2.7 0 5.3-.1 7.9-.4v20.4c0 43.4-35.2 78.6-78.6 78.6L78.6 480C35.2 480 0 444.8 0 401.4V110.6C0 67.2 35.2 32 78.6 32zM82.3 138.9l.3.1c13.2 3 19.8 7.4 19.8 23.4v187.2c0 16-6.7 20.4-19.9 23.4l-.3.1v2.8H135v-2.8l-.3-.1c-13.2-3-19.9-7.4-19.9-23.4V173.3l86.1 202.5h4.9l88.6-208.2v186.6c-1.1 12.6-7.8 16.5-19.7 19.2l-.3.1v2.7h91.9v-2.7l-.3-.1c-11.9-2.7-18.7-6.6-19.9-19.2l-.1-191.8h.1c0-16 6.7-20.4 19.9-23.4l.3-.1v-2.7h-72.2l-67 157.4-67-157.4H82.3zM448 340.3c-25.1-7.4-43-35.1-41.2-67.8h41.1v67.8zm-6.4-135.6c2.3 0 4.4.3 6.4.9V263h-40.2c1.5-33.6 13.6-57.9 33.8-58.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://imaddabbura.github.io/" target="_blank" rel="noopener" title="imaddabbura.github.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M351.9 280H161c2.9 64.5 17.2 123.9 37.5 167.4 11.4 24.5 23.7 41.8 35.1 52.4 11.2 10.5 18.9 12.2 22.9 12.2s11.7-1.7 22.9-12.2c11.4-10.6 23.7-28 35.1-52.4 20.3-43.5 34.6-102.9 37.5-167.4zm-191-48h190.9c-2.8-64.5-17.1-123.9-37.4-167.4-11.4-24.4-23.7-41.8-35.1-52.4C268.1 1.7 260.4 0 256.4 0s-11.7 1.7-22.9 12.2c-11.4 10.6-23.7 28-35.1 52.4-20.3 43.5-34.6 102.9-37.5 167.4m-48 0c3.5-85.6 25.6-165.1 57.9-217.3C78.7 47.3 10.9 131.2 1.5 232zM1.5 280c9.4 100.8 77.2 184.7 169.3 217.3-32.3-52.2-54.4-131.7-57.9-217.3zm398.4 0c-3.5 85.6-25.6 165.1-57.9 217.3 92.1-32.7 159.9-116.5 169.3-217.3zm111.4-48C501.9 131.2 434.1 47.3 342 14.7c32.3 52.2 54.4 131.7 57.9 217.3z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.50899def.min.js"></script>
      
    
  </body>
</html>